<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SnapArtistMapper">

  <!-- 스냅작가 등록 -->
  <insert id="createSnapArtist" parameterType="map" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO snap_artists
      (name, phone, email, instagram, business_number, available_time, main_images, floor_parking, equipment, shoot_guide, use_guide, etc, photographer_count, intro, intro_images, main_category, sub_categories, ad_category)
    VALUES
      (#{name}, #{phone}, #{email}, #{instagram}, #{business_number}, #{available_time}, #{main_images}, #{floor_parking}, #{equipment}, #{shoot_guide}, #{use_guide}, #{etc}, #{photographer_count}, #{intro}, #{intro_images}, #{main_category}, #{sub_categories}, #{ad_category})
  </insert>

  <!-- 스냅작가 목록 조회 -->
  <select id="getSnapArtists" resultType="map">
    SELECT * FROM snap_artists
    <where>
      <if test="category != null">
        AND main_category = #{category}
      </if>
    </where>
    ORDER BY id DESC
  </select>

  <!-- 스냅작가 상세 조회 -->
  <select id="getSnapArtistById" parameterType="int" resultType="map">
    SELECT * FROM snap_artists WHERE id = #{id}
  </select>

  <!-- 스냅작가 수정 -->
  <update id="updateSnapArtist" parameterType="map">
    UPDATE snap_artists
    SET
      name = #{name},
      phone = #{phone},
      email = #{email},
      instagram = #{instagram},
      business_number = #{business_number},
      available_time = #{available_time},
      main_images = #{main_images},
      floor_parking = #{floor_parking},
      equipment = #{equipment},
      shoot_guide = #{shoot_guide},
      use_guide = #{use_guide},
      etc = #{etc},
      photographer_count = #{photographer_count},
      intro = #{intro},
      intro_images = #{intro_images},
      main_category = #{main_category},
      sub_categories = #{sub_categories},
      ad_category = #{ad_category}
    WHERE id = #{id}
  </update>

  <!-- 스냅작가 삭제 -->
  <delete id="deleteSnapArtist" parameterType="int">
    DELETE FROM snap_artists WHERE id = #{id}
  </delete>

  <!-- ===== 상품 ===== -->

  <!-- 상품 등록 -->
  <insert id="createSnapProduct" parameterType="map" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO snap_products
      (artist_id, name, description, price, product_images)
    VALUES
      (#{artist_id}, #{name}, #{description}, #{price}, #{product_images})
  </insert>

  <!-- 상품 목록 조회 -->
  <select id="getSnapProductsByArtistId" parameterType="map" resultType="map">
    SELECT * FROM snap_products WHERE artist_id = #{artist_id} ORDER BY id DESC
  </select>

  <!-- 상품 상세 조회 -->
  <select id="getSnapProductById" parameterType="map" resultType="map">
    SELECT * FROM snap_products WHERE artist_id = #{artist_id} AND id = #{id}
  </select>

  <!-- 상품 수정 -->
  <update id="updateSnapProduct" parameterType="map">
    UPDATE snap_products
    SET
      name = #{name},
      description = #{description},
      price = #{price},
      product_images = #{product_images}
    WHERE artist_id = #{artist_id} AND id = #{id}
  </update>

  <!-- 상품 삭제 -->
  <delete id="deleteSnapProduct" parameterType="map">
    DELETE FROM snap_products WHERE artist_id = #{artist_id} AND id = #{id}
  </delete>

</mapper> 